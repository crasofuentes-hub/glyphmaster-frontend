<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GlyphMaster Studio</title>
  <link rel="stylesheet" href="./assets/styles.css" />
</head>
<body>
  <!-- Optional runtime config (safe): set backend base URL without rebuilding -->
  <script>
    // Example:
    // window.__GLYPHMASTER__ = { apiBaseUrl: "https://your-backend.example" };
    window.__GLYPHMASTER__ = window.__GLYPHMASTER__ || {};
  </script>

  <main class="gm-wrap">
    <header class="gm-topbar">
      <div class="gm-title">
        <h1>GlyphMaster Studio</h1>
        <p>
          Upload handwriting samples, build a personalized font via your backend (GSUB/GPOS, calt/liga/kern),
          and compose typed text into <strong>US Letter</strong> pages (max <strong>10</strong>) for print-ready output.
        </p>
      </div>
      <div id="apiBadge" class="gm-badge" aria-label="API status">API: Checking…</div>
    </header>

    <div class="gm-grid">
      <!-- Left: Build -->
      <section class="gm-card" aria-label="Font build panel">
        <div class="gm-card-h">
          <div>
            <h2>1) Handwriting samples → Font build</h2>
            <p class="sub">No keys in frontend. Backend handles security and font engineering.</p>
          </div>
        </div>
        <div class="gm-card-b">
          <div class="gm-row">
            <div id="dropZone" class="gm-drop" role="button" aria-label="Drop handwriting samples here or press Enter to browse" aria-describedby="samplesHint">
              <div>
                <strong>Drop images here</strong><br/>
                or click / press Enter to select files
              </div>
            </div>
            <input id="fileInput" type="file" accept="image/*" multiple class="sr-only" aria-hidden="true" />
          </div>

          <div class="gm-help" id="samplesHint" style="margin-top:10px;">
            Recommended: add at least 2 samples.
          </div>

          <div id="samplesList" class="gm-samples" aria-label="Selected samples"></div>

          <hr style="border:none;border-top:1px solid var(--border); margin:14px 0;">

          <div class="gm-row">
            <div style="flex:1; min-width:220px;">
              <div class="gm-help">Font family name (preview):</div>
              <input id="fontName" class="gm-input" value="GlyphMasterHand" aria-label="Font family name" />
            </div>
            <div style="flex:1; min-width:260px;">
              <div class="gm-help">Build options (JSON) sent to backend:</div>
              <input id="buildOptions" class="gm-input" value='{"format":"woff2"}' aria-label="Build options JSON" />
            </div>
          </div>

          <div class="gm-row gm-actions" style="margin-top:12px;">
            <button id="buildBtn" class="gm-btn gm-btn-primary" type="button" aria-label="Build font">Build font</button>
            <button id="downloadFontBtn" class="gm-btn gm-btn-success" type="button" aria-label="Download last built font" disabled>Download font</button>
          </div>

          <div class="gm-status" aria-live="polite" aria-atomic="true">
            <span class="muted">Status:</span>
            <span id="statusLive">Ready.</span>
          </div>
        </div>
      </section>

      <!-- Right: Composer -->
      <section class="gm-card" aria-label="US Letter compositor">
        <div class="gm-card-h">
          <div>
            <h2>2) Type → Compose into US Letter pages</h2>
            <p class="sub">Debounced rendering for long text. Print-ready layout.</p>
          </div>
        </div>
        <div class="gm-card-b">
          <div class="gm-row">
            <textarea id="textInput" class="gm-textarea" aria-label="Text to compose"
              placeholder="Type here. When your font is loaded, the pages will render in your handwriting style."></textarea>
          </div>

          <div id="overflowNote" class="gm-overflow" role="status" aria-live="polite" hidden></div>

          <div class="gm-row gm-actions" style="margin-top:10px;">
            <button id="printBtn" class="gm-btn" type="button" aria-label="Print pages">Print</button>
            <button id="clearBtn" class="gm-btn gm-btn-danger" type="button" aria-label="Clear text">Clear</button>
          </div>

          <div class="gm-pages-wrap" style="margin-top:14px;">
            <div id="pagesContainer" aria-label="Rendered pages"></div>
          </div>

          <div class="gm-help" style="margin-top:10px;">
            Note: Max output is <strong>10 pages</strong>. If content exceeds that, it will be truncated with an ellipsis.
          </div>
        </div>
      </section>
    </div>
  </main>

  <script type="module" src="./src/app.js"></script>
</body>
</html>
